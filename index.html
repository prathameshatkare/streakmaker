<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Streak Maker with Daily Learning, History, and Edit Feature</title>
    <style>
        * { box-sizing: border-box; }
        body { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            font-family: 'Arial', sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: linear-gradient(135deg, #6c5ce7, #00b894); 
            color: #ffffff; 
        }
        h1 { 
            color: #ffffff; 
            margin-bottom: 20px; 
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5); 
        }
        
        #learning-container { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            width: 100%; 
            max-width: 600px; 
            margin-bottom: 20px; 
            background: rgba(255, 255, 255, 0.9); 
            border-radius: 10px; 
            padding: 20px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.2); 
        }
        #learning-container textarea { 
            width: 100%; 
            height: 80px; 
            padding: 10px; 
            font-size: 16px; 
            resize: none; 
            border-radius: 5px; 
            border: 1px solid #ccc; 
            transition: border 0.3s; 
        }
        #learning-container textarea:focus { border: 1px solid #007bff; outline: none; }
        #save-learning-btn { 
            margin-top: 10px; 
            padding: 8px 16px; 
            font-size: 16px; 
            cursor: pointer; 
            background-color: #0984e3; 
            color: #fff; 
            border: none; 
            border-radius: 4px; 
            transition: background-color 0.3s; 
            box-shadow: 0 1px 5px rgba(0,0,0,0.2);
        }
        #save-learning-btn:hover { background-color: #74b9ff; }

        #history-container { 
            margin-top: 20px; 
            max-width: 600px; 
            width: 100%; 
            border-top: 1px solid #231d1d; 
            padding-top: 10px; 
            background: rgba(24, 84, 173, 0.9); 
            border-radius: 10px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.2); 
        }
        .history-item { 
            margin-bottom: 10px; 
            padding: 8px; 
            border: 1px solid #1b1111; 
            border-radius: 5px; 
            background-color: rgba(240, 240, 240, 0.9); 
            transition: background-color 0.3s; 
        }
        .history-item:hover { background-color: #dfe6e9; }
        .history-date { font-weight: bold; color: #333; }
        .history-note { margin-top: 5px;color: black; }
        .edit-note, .save-edit { 
            font-size: 14px; 
            margin-top: 5px; 
            padding: 5px; 
            cursor: pointer; 
            color: #b92430; 
            border: none; 
            background: none; 
            text-decoration: underline; 
            transition: color 0.3s; 
        }
        .edit-note:hover, .save-edit:hover { color: #74b9ff; }
        
        #streak-container { 
            display: grid; 
            grid-template-columns: repeat(52, 20px); 
            grid-template-rows: repeat(7, 20px); 
            gap: 5px; 
            margin-top: 20px; 
            justify-content: center; 
        }
        .streak-box { 
            width: 20px; 
            height: 20px; 
            background-color: #b2bec3; 
            border-radius: 3px; 
            cursor: pointer; 
            transition: background-color 0.3s; 
            position: relative; 
        }
        .streak-box.active { background-color: #00b894; }
        .streak-box:hover::after { 
            content: attr(data-date); 
            position: absolute; 
            bottom: 25px; 
            left: 50%; 
            transform: translateX(-50%); 
            padding: 4px 8px; 
            background-color: #333; 
            color: #fff; 
            font-size: 12px; 
            border-radius: 3px; 
            white-space: nowrap; 
            opacity: 0.9; 
        }
        
        #controls { 
            margin-top: 20px; 
            display: flex; 
            gap: 15px; 
            align-items: center; 
        }
        #streak-count, #total-count { 
            font-size: 16px; 
            color: #333; 
            background: rgba(255, 255, 255, 0.9); 
            border-radius: 5px; 
            padding: 5px 10px; 
            box-shadow: 0 1px 5px rgba(0,0,0,0.2); 
        }
        #reset-btn { 
            padding: 6px 12px; 
            font-size: 16px; 
            cursor: pointer; 
            background-color: #d63031; 
            color: #fff; 
            border: none; 
            border-radius: 4px; 
            transition: background-color 0.3s; 
            box-shadow: 0 1px 5px rgba(0,0,0,0.2);
        }
        #reset-btn:hover { background-color: #ff6b81; }
    </style>
</head>
<body>
    <h1>Streak Maker with Daily Learning, History, and Edit Feature</h1>
    
    <div id="learning-container">
        <textarea id="learning-input" placeholder="What did you learn today?"></textarea>
        <button id="save-learning-btn">Save Learning</button>
    </div>

    <div id="history-container">
        <h2>Learning History</h2>
        <div id="history-list"></div>
    </div>

    <div id="streak-container"></div>
    
    <div id="controls">
        <span id="streak-count">Current Streak: 0</span>
        <span id="total-count">Total Active Days: 0</span>
        <button id="reset-btn">Reset Streak</button>
    </div>
    
    <script>
        const streakContainer = document.getElementById('streak-container');
        const streakCountDisplay = document.getElementById('streak-count');
        const totalCountDisplay = document.getElementById('total-count');
        const resetButton = document.getElementById('reset-btn');
        const learningInput = document.getElementById('learning-input');
        const saveLearningButton = document.getElementById('save-learning-btn');
        const historyList = document.getElementById('history-list');
        const daysInYear = 365;

        function formatDate(date) {
            return date.toISOString().split('T')[0];
        }

        const today = new Date();
        let currentStreak = 0;
        let totalActiveDays = 0;

        for (let i = 0; i < daysInYear; i++) {
            const streakBox = document.createElement('div');
            streakBox.classList.add('streak-box');
            const date = new Date();
            date.setDate(today.getDate() - i);
            const dateString = formatDate(date);
            streakBox.setAttribute('data-date', dateString);

            streakBox.addEventListener('click', () => {
                streakBox.classList.toggle('active');
                updateCounts();
            });

            streakContainer.appendChild(streakBox);
        }

        function updateCounts() {
            const boxes = Array.from(document.querySelectorAll('.streak-box'));
            let streak = 0;
            let total = 0;
            let inStreak = false;

            boxes.reverse().forEach(box => {
                if (box.classList.contains('active')) {
                    total++;
                    if (inStreak) {
                        streak++;
                    } else {
                        inStreak = true;
                        streak = 1;
                    }
                } else {
                    inStreak = false;
                }
            });

            currentStreak = streak;
            totalActiveDays = total;
            streakCountDisplay.textContent = `Current Streak: ${currentStreak}`;
            totalCountDisplay.textContent = `Total Active Days: ${totalActiveDays}`;
        }

        resetButton.addEventListener('click', () => {
            if (confirm("Are you sure you want to reset your streak?")) {
                localStorage.removeItem('streakData');
                document.querySelectorAll('.streak-box').forEach(box => box.classList.remove('active'));
                updateCounts();
            }
        });

        function loadLearningHistory() {
            const learningHistory = JSON.parse(localStorage.getItem('learningHistory') || '[]');
            learningHistory.forEach(entry => addHistoryItem(entry.date, entry.text));
        }

        function addHistoryItem(date, text) {
            const historyItem = document.createElement('div');
            historyItem.classList.add('history-item');
            const noteDisplay = document.createElement('div');
            noteDisplay.classList.add('history-note');
            noteDisplay.textContent = text;

            const editButton = document.createElement('button');
            editButton.classList.add('edit-note');
            editButton.textContent = "Edit";

            editButton.addEventListener('click', () => {
                const editableText = document.createElement('textarea');
                editableText.value = text;
                const saveButton = document.createElement('button');
                saveButton.classList.add('save-edit');
                saveButton.textContent = "Save";

                historyItem.replaceChild(editableText, noteDisplay);
                historyItem.appendChild(saveButton);
                editButton.style.display = 'none';

                saveButton.addEventListener('click', () => {
                    const newText = editableText.value;
                    const learningHistory = JSON.parse(localStorage.getItem('learningHistory') || '[]');
                    const index = learningHistory.findIndex(entry => entry.date === date && entry.text === text);

                    if (index !== -1) {
                        learningHistory[index].text = newText;
                        localStorage.setItem('learningHistory', JSON.stringify(learningHistory));
                        noteDisplay.textContent = newText;
                        historyItem.replaceChild(noteDisplay, editableText);
                        saveButton.remove();
                        editButton.style.display = 'inline';
                        alert("Learning note updated!");
                    }
                });
            });

            historyItem.innerHTML = `<div class="history-date">${date}</div>`;
            historyItem.appendChild(noteDisplay);
            historyItem.appendChild(editButton);
            historyList.appendChild(historyItem);
        }

        saveLearningButton.addEventListener('click', () => {
            const learningText = learningInput.value.trim();
            if (learningText) {
                const date = formatDate(today);
                const learningHistory = JSON.parse(localStorage.getItem('learningHistory') || '[]');
                learningHistory.push({ date, text: learningText });
                localStorage.setItem('learningHistory', JSON.stringify(learningHistory));
                addHistoryItem(date, learningText);
                learningInput.value = ''; // Clear the input
            } else {
                alert("Please enter a learning note.");
            }
        });

        loadLearningHistory();
        updateCounts();
    </script>
</body>
</html>
